<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
</head>
<body>
    <h1>Admin Dashboard</h1>

    <!-- إضافة فئة جديدة -->
    <div>
        <h2>Add Category</h2>
        <input type="text" id="categoryName" placeholder="Category Name">
        <button onclick="addCategory()">Add Category</button>
    </div>

    <!-- إضافة سؤال جديد -->
    <div>
        <h2>Add Question</h2>
        <input type="text" id="questionText" placeholder="Question Text">
        <input type="text" id="questionImageUrl" placeholder="Image URL">
        <input type="text" id="questionVideoUrl" placeholder="Video URL">
        <input type="text" id="questionAudioUrl" placeholder="Audio URL">
        <input type="text" id="correctAnswer" placeholder="Correct Answer">
        <input type="text" id="questionPoints" placeholder="Points">
        <input type="text" id="questionDifficulty" placeholder="Difficulty">
        <button onclick="addQuestion()">Add Question</button>
    </div>

    <!-- عرض الفئات والأسئلة -->
    <div>
        <h2>Categories and Questions</h2>
        <div id="categoriesList"></div>
        <div id="questionsList"></div>
    </div>

    <script>
        // تكوين Firebase
        const firebaseConfig = {
            apiKey: "API_KEY",
            authDomain: "PROJECT_ID.firebaseapp.com",
            projectId: "PROJECT_ID",
            storageBucket: "PROJECT_ID.appspot.com",
            messagingSenderId: "SENDER_ID",
            appId: "APP_ID"
        };

        // تهيئة Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // إضافة فئة جديدة
        function addCategory() {
            const categoryName = document.getElementById('categoryName').value;
            db.collection("categories").add({
                name: categoryName
            })
            .then(() => {
                alert("Category added successfully");
                loadCategories(); // إعادة تحميل الفئات بعد الإضافة
            })
            .catch(error => {
                console.error("Error adding category: ", error);
            });
        }

        // إضافة سؤال جديد
        function addQuestion() {
            const questionData = {
                text: document.getElementById('questionText').value,
                imageUrl: document.getElementById('questionImageUrl').value,
                videoUrl: document.getElementById('questionVideoUrl').value,
                audioUrl: document.getElementById('questionAudioUrl').value,
                correctAnswer: document.getElementById('correctAnswer').value,
                points: parseInt(document.getElementById('questionPoints').value),
                difficulty: document.getElementById('questionDifficulty').value,
                category: selectedCategoryId // تأكد من تعيين الفئة المحددة
            };

            db.collection("categories").doc(selectedCategoryId).collection("questions").add(questionData)
            .then(() => {
                alert("Question added successfully");
                loadQuestions(selectedCategoryId); // إعادة تحميل الأسئلة بعد الإضافة
            })
            .catch(error => {
                console.error("Error adding question: ", error);
            });
        }

        // تحميل الفئات
        function loadCategories() {
            db.collection("categories").get().then(querySnapshot => {
                const categoriesList = document.getElementById('categoriesList');
                categoriesList.innerHTML = ''; // تفريغ القائمة الحالية
                querySnapshot.forEach(doc => {
                    const category = doc.data();
                    categoriesList.innerHTML += `<div onclick="loadQuestions('${doc.id}')">${category.name}</div>`;
                });
            });
        }

        // تحميل الأسئلة لفئة معينة
        function loadQuestions(categoryId) {
            selectedCategoryId = categoryId; // تخزين معرف الفئة المحددة
            db.collection("categories").doc(categoryId).collection("questions").get().then(querySnapshot => {
                const questionsList = document.getElementById('questionsList');
                questionsList.innerHTML = ''; // تفريغ القائمة الحالية
                querySnapshot.forEach(doc => {
                    const question = doc.data();
                    questionsList.innerHTML += `<div>${question.text}</div>`;
                });
            });
        }

        // استدعاء الدوال لبدء تحميل الفئات
        loadCategories();
    </script>
</body>
</html>
